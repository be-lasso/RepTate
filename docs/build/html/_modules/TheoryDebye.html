

<!doctype html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>TheoryDebye &#8212; RepTate 1.0.0 20200330 documentation</title>
    <link rel="stylesheet" href="../_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/bizstyle.js"></script>
    <link rel="shortcut icon" href="../_static/Reptate64.ico"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">RepTate 1.0.0 20200330 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/RepTatelogo.jpg" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for TheoryDebye</h1><div class="highlight"><pre>
<span></span><span class="c1"># RepTate: Rheology of Entangled Polymers: Toolkit for the Analysis of Theory and Experiments</span>
<span class="c1"># --------------------------------------------------------------------------------------------------------</span>
<span class="c1">#</span>
<span class="c1"># Authors:</span>
<span class="c1">#     Jorge Ramirez, jorge.ramirez@upm.es</span>
<span class="c1">#     Victor Boudara, victor.boudara@gmail.com</span>
<span class="c1">#</span>
<span class="c1"># Useful links:</span>
<span class="c1">#     http://blogs.upm.es/compsoftmatter/software/reptate/</span>
<span class="c1">#     https://github.com/jorge-ramirez-upm/RepTate</span>
<span class="c1">#     http://reptate.readthedocs.io</span>
<span class="c1">#</span>
<span class="c1"># --------------------------------------------------------------------------------------------------------</span>
<span class="c1">#</span>
<span class="c1"># Copyright (2017-2020): Jorge Ramirez, Victor Boudara, Universidad Polit√©cnica de Madrid, University of Leeds</span>
<span class="c1">#</span>
<span class="c1"># This file is part of RepTate.</span>
<span class="c1">#</span>
<span class="c1"># RepTate is free software: you can redistribute it and/or modify</span>
<span class="c1"># it under the terms of the GNU General Public License as published by</span>
<span class="c1"># the Free Software Foundation, either version 3 of the License, or</span>
<span class="c1"># (at your option) any later version.</span>
<span class="c1">#</span>
<span class="c1"># RepTate is distributed in the hope that it will be useful,</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1"># GNU General Public License for more details.</span>
<span class="c1">#</span>
<span class="c1"># You should have received a copy of the GNU General Public License</span>
<span class="c1"># along with RepTate.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="c1">#</span>
<span class="c1"># --------------------------------------------------------------------------------------------------------</span>
<span class="sd">&quot;&quot;&quot;Module TheoryDebye</span>

<span class="sd">Debye theory for neutron scattering from ideal polymer chains</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">CmdBase</span> <span class="k">import</span> <span class="n">CmdBase</span><span class="p">,</span> <span class="n">CmdMode</span>
<span class="kn">from</span> <span class="nn">Parameter</span> <span class="k">import</span> <span class="n">Parameter</span><span class="p">,</span> <span class="n">ParameterType</span><span class="p">,</span> <span class="n">OptType</span>
<span class="kn">from</span> <span class="nn">Theory</span> <span class="k">import</span> <span class="n">Theory</span>
<span class="kn">from</span> <span class="nn">QTheory</span> <span class="k">import</span> <span class="n">QTheory</span>
<span class="kn">from</span> <span class="nn">DataTable</span> <span class="k">import</span> <span class="n">DataTable</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span> <span class="k">import</span> <span class="n">QToolBar</span><span class="p">,</span> <span class="n">QAction</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtCore</span> <span class="k">import</span> <span class="n">QSize</span><span class="p">,</span> <span class="n">QUrl</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtGui</span> <span class="k">import</span> <span class="n">QIcon</span><span class="p">,</span> <span class="n">QDesktopServices</span>


<div class="viewcode-block" id="TheoryDebye"><a class="viewcode-back" href="../manual/Applications/SANS/Theory/theory.html#TheoryDebye.TheoryDebye">[docs]</a><span class="k">class</span> <span class="nc">TheoryDebye</span><span class="p">(</span><span class="n">CmdBase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Fit a Debye function to the small angle neutron scattering data of ideal polymer chains. </span>
<span class="sd">    </span>
<span class="sd">    * **Function**</span>
<span class="sd">        .. math::</span>
<span class="sd">            I(q) = \\frac {(b_H-b_D)^2}{V} N \\phi(1-\\phi) g_D(R_g,q) + \\mathrm{Bckgrnd}</span>
<span class="sd">        </span>
<span class="sd">        where:</span>
<span class="sd">          - :math:`N=M_w/M_\\mathrm{mono}` is the degree of polymerization of the chain (:math:`M_w` is a parameter of the experimental data)</span>
<span class="sd">          - :math:`\\phi` is the volume fraction of deuterated chains (read from the file)</span>
<span class="sd">          - :math:`g_D(R_g,q)` is the Debye function, given by</span>
<span class="sd">          </span>
<span class="sd">          .. math::</span>
<span class="sd">              g_D(R_g,q) = \\frac{2}{(q^2R_g^2)^2}\\left( q^2R_g^2 + exp(-q^2R_g^2) -1 \\right)</span>
<span class="sd">    </span>
<span class="sd">    * **Parameters**</span>
<span class="sd">       - Contrast: This sets the magnitude of the scattering and is equal to :math:`(b_H-b_D)^2/V` where :math:`b_{H/D}` is the scattering cross-section of the hydrogenous/deuterated monomer and :math:`V` is the monomer volume. </span>
<span class="sd">       - :math:`C_{gyr}`: This sets the scale of the radius of gyration of the chain. For a given molecular weight, the radius of gyration is :math:`R_g^2=C_{gyr}M_w`. For many polymers, this value is available in the literature, but small adjustments may still be necessary to optimize the agreement with the experimental data.</span>
<span class="sd">       - :math:`M_\\mathrm{mono}`: The molecular weight of a single monomer (should be known from the chain chemistry).</span>
<span class="sd">       - Bckgrnd: This sets the level of the background scattering. It can, in principle, be computed from known incoherent scattering cross sections but, in practice, there are often many other unknown contributions and therefore fitting is necessary.</span>
<span class="sd">       - :math:`\\lambda`: It applies a simple strain measure by shifting the radius of gyration by a constant factor for all :math:`q` values, :math:`R_g\\to \\lambda R_g` (the **Stretched** button must be checked). This can be used to compare the microscopic deformation with the effect of a fully affine bulk deformation or to fit to the low :math:`q` data to produce an effective radius of gyration under flow. Compression perpendicular to the flow direction can be modelled by setting :math:`\\lambda&lt;1`.</span>
<span class="sd">       - :math:`\\chi`: Parameter to model the effect of a weak interaction between the hydrogenous and the deuterated monomers on the scattering, modelled within the random phase approximation [3] (the **Non-Ideal Mix** button must be checked). The scattered intensity is calculated according to the function below, in which :math:`\\chi` is independent of :math:`M_w` and :math:`\\phi` but is expected to change with temperature. Typically, the effect of :math:`\\chi` is small, but this depends upon the temperature, degree of polymerization and deuterated fraction. For deuterated/hydrogenated polystyrene :math:`\\chi\\approx 1.7\cdot 10^{-4}` at 160 degrees C, and it is expected to be smaller with increasing temperature.</span>
<span class="sd">         </span>
<span class="sd">         .. math::</span>
<span class="sd">             I(q) = \\frac {(b_H-b_D)^2}{V} \\left( \\frac{1}{N \\phi(1-\\phi) g_D(R_g,q)}-2\\chi \\right)^{-1} + \\mathrm{Bckgrnd}     </span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">thname</span> <span class="o">=</span> <span class="s1">&#39;Debye&#39;</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;Debye theory for neutron scattering from ideal polymer chains&#39;</span>
    <span class="n">citations</span> <span class="o">=</span> <span class="s1">&#39;Debye P., J. Phys. Chem. 1947, 51, 18-32&#39;</span>
    <span class="n">doi</span> <span class="o">=</span> <span class="s2">&quot;http://dx.doi.org/10.1021/j150451a002&quot;</span>

    <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">parent_dataset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axarr</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;[summary]</span>
<span class="sd">        </span>
<span class="sd">        [description]</span>
<span class="sd">        </span>
<span class="sd">        Keyword Arguments:</span>
<span class="sd">            - name {[type]} -- [description] (default: {&#39;&#39;})</span>
<span class="sd">            - parent_dataset {[type]} -- [description] (default: {None})</span>
<span class="sd">            - ax {[type]} -- [description] (default: {None})</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            - [type] -- [description]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">GUITheoryDebye</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span> <span class="n">parent_dataset</span><span class="p">,</span>
            <span class="n">axarr</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">CmdBase</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="n">CmdMode</span><span class="o">.</span><span class="n">GUI</span><span class="p">)</span> <span class="k">else</span> <span class="n">CLTheoryDebye</span><span class="p">(</span>
                <span class="n">name</span><span class="p">,</span> <span class="n">parent_dataset</span><span class="p">,</span> <span class="n">axarr</span><span class="p">)</span></div>


<span class="k">class</span> <span class="nc">BaseTheoryDebye</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;[summary]</span>
<span class="sd">    </span>
<span class="sd">    [description]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">help_file</span> <span class="o">=</span> <span class="s1">&#39;http://reptate.readthedocs.io/manual/Applications/SANS/Theory/theory.html#debye-function&#39;</span>
    <span class="n">single_file</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># False if the theory can be applied to multiple files simultaneously</span>
    <span class="n">thname</span> <span class="o">=</span> <span class="n">TheoryDebye</span><span class="o">.</span><span class="n">thname</span>
    <span class="n">citations</span> <span class="o">=</span> <span class="n">TheoryDebye</span><span class="o">.</span><span class="n">citations</span>
    <span class="n">doi</span> <span class="o">=</span> <span class="n">TheoryDebye</span><span class="o">.</span><span class="n">doi</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">parent_dataset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axarr</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Constructor**</span>
<span class="sd">        </span>
<span class="sd">        Keyword Arguments:</span>
<span class="sd">            - name {[type]} -- [description] (default: {&#39;&#39;})</span>
<span class="sd">            - parent_dataset {[type]} -- [description] (default: {None})</span>
<span class="sd">            - ax {[type]} -- [description] (default: {None})</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">parent_dataset</span><span class="p">,</span> <span class="n">axarr</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">function</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculateDebye</span>  <span class="c1"># main theory function</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">has_modes</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># True if the theory has modes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Contrast&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Contrast&#39;</span><span class="p">,</span>
            <span class="n">value</span><span class="o">=</span><span class="mf">0.4203</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Magnitude of the scattering&#39;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="n">ParameterType</span><span class="o">.</span><span class="n">real</span><span class="p">,</span>
            <span class="n">opt_type</span><span class="o">=</span><span class="n">OptType</span><span class="o">.</span><span class="n">const</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;C_gyr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;C_gyr&#39;</span><span class="p">,</span>
            <span class="n">value</span><span class="o">=</span><span class="mf">62.3</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Scale the radius of gyration&#39;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="n">ParameterType</span><span class="o">.</span><span class="n">real</span><span class="p">,</span>
            <span class="n">opt_type</span><span class="o">=</span><span class="n">OptType</span><span class="o">.</span><span class="n">const</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;M_mono&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;M_mono&#39;</span><span class="p">,</span>
            <span class="n">value</span><span class="o">=</span><span class="mf">0.104</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Molecular weight of a monomer&#39;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="n">ParameterType</span><span class="o">.</span><span class="n">real</span><span class="p">,</span>
            <span class="n">opt_type</span><span class="o">=</span><span class="n">OptType</span><span class="o">.</span><span class="n">const</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Bckgrnd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Bckgrnd&#39;</span><span class="p">,</span>
            <span class="n">value</span><span class="o">=</span><span class="mf">0.26</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Level of background scattering&#39;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="n">ParameterType</span><span class="o">.</span><span class="n">real</span><span class="p">,</span>
            <span class="n">opt_type</span><span class="o">=</span><span class="n">OptType</span><span class="o">.</span><span class="n">opt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Chi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Chi&#39;</span><span class="p">,</span>
            <span class="n">value</span><span class="o">=</span><span class="mf">1E-4</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Effect of weak interaction between &quot;&lt;sup&gt;2&lt;/sup&gt;H and H&quot;&#39;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="n">ParameterType</span><span class="o">.</span><span class="n">real</span><span class="p">,</span>
            <span class="n">opt_type</span><span class="o">=</span><span class="n">OptType</span><span class="o">.</span><span class="n">const</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Lambda&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Lambda&#39;</span><span class="p">,</span>
            <span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Shift of the radius of gyration&#39;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="n">ParameterType</span><span class="o">.</span><span class="n">real</span><span class="p">,</span>
            <span class="n">opt_type</span><span class="o">=</span><span class="n">OptType</span><span class="o">.</span><span class="n">const</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;stretched&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;stretched&quot;</span><span class="p">,</span>
            <span class="n">value</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Is shifting the radius of gyration applied&quot;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="n">ParameterType</span><span class="o">.</span><span class="n">boolean</span><span class="p">,</span>
            <span class="n">opt_type</span><span class="o">=</span><span class="n">OptType</span><span class="o">.</span><span class="n">const</span><span class="p">,</span>
            <span class="n">display_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;non-ideal&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;non-ideal&quot;</span><span class="p">,</span>
            <span class="n">value</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Is non-ideal mix&quot;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="n">ParameterType</span><span class="o">.</span><span class="n">boolean</span><span class="p">,</span>
            <span class="n">opt_type</span><span class="o">=</span><span class="n">OptType</span><span class="o">.</span><span class="n">const</span><span class="p">,</span>
            <span class="n">display_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">calculateDebye</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Debye function that returns the square of y</span>
<span class="sd">        </span>
<span class="sd">        [description]</span>
<span class="sd">        </span>
<span class="sd">        Keyword Arguments:</span>
<span class="sd">            - f {[type]} -- [description] (default: {None})</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            - [type] -- [description]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ft</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">data_table</span>
        <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">file_name_short</span><span class="p">]</span>
        <span class="n">tt</span><span class="o">.</span><span class="n">num_columns</span> <span class="o">=</span> <span class="n">ft</span><span class="o">.</span><span class="n">num_columns</span>
        <span class="n">tt</span><span class="o">.</span><span class="n">num_rows</span> <span class="o">=</span> <span class="n">ft</span><span class="o">.</span><span class="n">num_rows</span>
        <span class="n">tt</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">tt</span><span class="o">.</span><span class="n">num_rows</span><span class="p">,</span> <span class="n">tt</span><span class="o">.</span><span class="n">num_columns</span><span class="p">))</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">Mw</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">file_parameters</span><span class="p">[</span><span class="s2">&quot;Mw&quot;</span><span class="p">])</span>
            <span class="n">Phi</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">file_parameters</span><span class="p">[</span><span class="s2">&quot;Phi&quot;</span><span class="p">])</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">KeyError</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Qprint</span><span class="p">(</span><span class="s2">&quot;Invalid Mw or Phi value&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">Contr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;Contrast&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
        <span class="n">CRg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;C_gyr&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
        <span class="n">Mmono</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;M_mono&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
        <span class="n">Bck</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;Bckgrnd&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
        <span class="n">Chi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;Chi&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
        <span class="n">Lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;Lambda&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
        <span class="n">stretched</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;stretched&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
        <span class="n">nonideal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;non-ideal&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>

        <span class="n">tt</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">ft</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>

        <span class="n">Rg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">CRg</span> <span class="o">*</span> <span class="n">Mw</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">stretched</span><span class="p">):</span>
            <span class="n">Rg</span> <span class="o">*=</span> <span class="n">Lambda</span>
        <span class="n">RgQsq</span> <span class="o">=</span> <span class="n">Rg</span> <span class="o">*</span> <span class="n">Rg</span> <span class="o">*</span> <span class="n">ft</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">ft</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">debFn</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">/</span> <span class="n">RgQsq</span> <span class="o">/</span> <span class="n">RgQsq</span> <span class="o">*</span> <span class="p">(</span><span class="n">RgQsq</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">RgQsq</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">nonideal</span><span class="p">):</span>
            <span class="n">tt</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Contr</span> <span class="o">*</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span>
                                         <span class="p">(</span><span class="n">Mw</span> <span class="o">/</span> <span class="n">Mmono</span> <span class="o">*</span> <span class="n">Phi</span> <span class="o">*</span>
                                          <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">Phi</span><span class="p">)</span> <span class="o">*</span> <span class="n">debFn</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">Chi</span><span class="p">)</span> <span class="o">+</span> <span class="n">Bck</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tt</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span>
                    <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Contr</span> <span class="o">*</span> <span class="n">Mw</span> <span class="o">/</span> <span class="n">Mmono</span> <span class="o">*</span> <span class="n">Phi</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">Phi</span><span class="p">)</span> <span class="o">*</span> <span class="n">debFn</span> <span class="o">+</span> <span class="n">Bck</span>

    <span class="k">def</span> <span class="nf">do_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">do_error</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">line</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Qprint</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Qprint</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%12s</span><span class="s2"> </span><span class="si">%8s</span><span class="s2"> </span><span class="si">%8s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s2">&quot;File&quot;</span><span class="p">,</span> <span class="s2">&quot;Mw&quot;</span><span class="p">,</span> <span class="s2">&quot;Rg&quot;</span><span class="p">))</span>
            <span class="n">CRg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;C_gyr&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
            <span class="n">Lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;Lambda&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
            <span class="n">stretched</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;stretched&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
            <span class="n">nfiles</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent_dataset</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nfiles</span><span class="p">):</span>
                <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent_dataset</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">active</span><span class="p">):</span>
                    <span class="n">Mw</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">file_parameters</span><span class="p">[</span><span class="s2">&quot;Mw&quot;</span><span class="p">])</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">stretched</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">Qprint</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%12s</span><span class="s2"> </span><span class="si">%8.4g</span><span class="s2"> </span><span class="si">%8.4g</span><span class="s2">&quot;</span> <span class="o">%</span>
                                    <span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">file_name_short</span><span class="p">,</span> <span class="n">Mw</span><span class="p">,</span>
                                     <span class="n">Lambda</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">CRg</span> <span class="o">*</span> <span class="n">Mw</span><span class="p">)))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">Qprint</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%12s</span><span class="s2"> </span><span class="si">%8.4g</span><span class="s2"> </span><span class="si">%8.4g</span><span class="s2">&quot;</span> <span class="o">%</span>
                                    <span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">file_name_short</span><span class="p">,</span> <span class="n">Mw</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">CRg</span> <span class="o">*</span> <span class="n">Mw</span><span class="p">)))</span>


<span class="k">class</span> <span class="nc">CLTheoryDebye</span><span class="p">(</span><span class="n">BaseTheoryDebye</span><span class="p">,</span> <span class="n">Theory</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;[summary]</span>
<span class="sd">    </span>
<span class="sd">    [description]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">parent_dataset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axarr</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Constructor**</span>
<span class="sd">        </span>
<span class="sd">        Keyword Arguments:</span>
<span class="sd">            - name {[type]} -- [description] (default: {&#39;&#39;})</span>
<span class="sd">            - parent_dataset {[type]} -- [description] (default: {None})</span>
<span class="sd">            - ax {[type]} -- [description] (default: {None})</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">parent_dataset</span><span class="p">,</span> <span class="n">axarr</span><span class="p">)</span>

    <span class="c1"># This class usually stays empty</span>


<span class="k">class</span> <span class="nc">GUITheoryDebye</span><span class="p">(</span><span class="n">BaseTheoryDebye</span><span class="p">,</span> <span class="n">QTheory</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;[summary]</span>
<span class="sd">    </span>
<span class="sd">    [description]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">parent_dataset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axarr</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Constructor**</span>
<span class="sd">        </span>
<span class="sd">        Keyword Arguments:</span>
<span class="sd">            - name {[type]} -- [description] (default: {&#39;&#39;})</span>
<span class="sd">            - parent_dataset {[type]} -- [description] (default: {None})</span>
<span class="sd">            - ax {[type]} -- [description] (default: {None})</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">parent_dataset</span><span class="p">,</span> <span class="n">axarr</span><span class="p">)</span>

        <span class="c1"># add widgets specific to the theory here:</span>
        <span class="n">tb</span> <span class="o">=</span> <span class="n">QToolBar</span><span class="p">()</span>
        <span class="n">tb</span><span class="o">.</span><span class="n">setIconSize</span><span class="p">(</span><span class="n">QSize</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">24</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tbutstretched</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span>
            <span class="n">QIcon</span><span class="p">(</span><span class="s1">&#39;:/Icon8/Images/new_icons/icons8-socks.png&#39;</span><span class="p">),</span> <span class="s1">&#39;Stretched&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tbutstretched</span><span class="o">.</span><span class="n">setCheckable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tbutstretched</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tbutnonideal</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span>
            <span class="n">QIcon</span><span class="p">(</span><span class="s1">&#39;:/Images/Images/new_icons/icons8-broom.png&#39;</span><span class="p">),</span>
            <span class="s1">&#39;Non-Ideal Mix&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tbutnonideal</span><span class="o">.</span><span class="n">setCheckable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tbutnonideal</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thToolsLayout</span><span class="o">.</span><span class="n">insertWidget</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tb</span><span class="p">)</span>

        <span class="c1">#connections signal and slots</span>
        <span class="n">connection_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tbutstretched</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">handle_tbutstretched_triggered</span><span class="p">)</span>
        <span class="n">connection_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tbutnonideal</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">handle_tbutnonideal_triggered</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">handle_tbutstretched_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">checked</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;[summary]</span>
<span class="sd">        </span>
<span class="sd">        [description]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_param_value</span><span class="p">(</span><span class="s2">&quot;stretched&quot;</span><span class="p">,</span> <span class="n">checked</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">handle_tbutnonideal_triggered</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">checked</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;[summary]</span>
<span class="sd">        </span>
<span class="sd">        [description]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_param_value</span><span class="p">(</span><span class="s2">&quot;non-ideal&quot;</span><span class="p">,</span> <span class="n">checked</span><span class="p">)</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">RepTate 1.0.0 20200330 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Universidad Polit√©cnica de Madrid, University of Leeds.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.3.1.
    </div>
  </body>
</html>